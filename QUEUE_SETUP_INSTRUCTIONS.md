# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å–∏—Å—Ç–µ–º—ã –æ—á–µ—Ä–µ–¥–µ–π –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å–µ–º

## –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. **–°–∏—Å—Ç–µ–º–∞ –æ—á–µ—Ä–µ–¥–µ–π Laravel Queue**
- –°–æ–∑–¥–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ `jobs` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
- –ù–∞—Å—Ç—Ä–æ–µ–Ω –¥—Ä–∞–π–≤–µ—Ä –æ—á–µ—Ä–µ–¥–∏: `database` (–≤ `.env` –∏–∑–º–µ–Ω–µ–Ω–æ `QUEUE_CONNECTION=database`)
- –ü–∏—Å—å–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å, –Ω–µ –±–ª–æ–∫–∏—Ä—É—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### 2. **Mail –∫–ª–∞—Å—Å –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**
- `app/Mail/CastingInvitationMail.php` - –∫–ª–∞—Å—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π
- –ö—Ä–∞—Å–∏–≤—ã–π HTML-—à–∞–±–ª–æ–Ω –ø–∏—Å—å–º–∞: `resources/views/emails/casting-invitation.blade.php`
- –î–∏–∑–∞–π–Ω –≤ —Å—Ç–∏–ª–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ–º

### 3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –Ω–∞ –∫–∞—Å—Ç–∏–Ω–≥**
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –º–æ–¥–µ–ª–µ–π —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –ø–∏—Å—å–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å
- –ö–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–∏—Å—å–º–æ —Å –¥–µ—Ç–∞–ª—è–º–∏ –∫–∞—Å—Ç–∏–Ω–≥–∞

### 4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏ —á–µ—Ä–µ–∑ Scheduler**
- `app/Console/Kernel.php` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–∏ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- –ö–æ–º–∞–Ω–¥–∞: `queue:work --stop-when-empty --tries=3`

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ/–ª–æ–∫–∞–ª—å–Ω–æ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π Queue Worker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production)

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
```bash
php artisan queue:work --sleep=3 --tries=3
```

–≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ. –î–ª—è production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Supervisor.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Windows Task Scheduler (–¥–ª—è Windows/OSPanel)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞–Ω–∏–π Windows"** (Task Scheduler)

2. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ:**
   - –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é –∑–∞–¥–∞—á—É"
   - –ò–º—è: `Laravel Scheduler`
   - –¢—Ä–∏–≥–≥–µ—Ä: –ü–æ–≤—Ç–æ—Ä—è—é—â–µ–µ—Å—è –∑–∞–¥–∞–Ω–∏–µ
   - –ò–Ω—Ç–µ—Ä–≤–∞–ª: **–ö–∞–∂–¥—É—é 1 –º–∏–Ω—É—Ç—É**
   
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:**
   - –î–µ–π—Å—Ç–≤–∏–µ: –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É
   - –ü—Ä–æ–≥—Ä–∞–º–º–∞: `C:\OSPanel\domains\agency\scheduler.bat`
   - –ù–∞—á–∞—Ç—å –≤: `C:\OSPanel\domains\agency`

4. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
   - ‚úÖ –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
   - ‚úÖ –í—ã–ø–æ–ª–Ω—è—Ç—å, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–æ—à–µ–ª –≤ —Å–∏—Å—Ç–µ–º—É
   - ‚úÖ –ó–∞–ø—É—Å–∫–∞—Ç—å —Å –Ω–∞–∏–≤—ã—Å—à–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ Cron (–¥–ª—è Linux)

–î–æ–±–∞–≤—å—Ç–µ –≤ crontab:
```bash
* * * * * cd /path/to/agency && php artisan schedule:run >> /dev/null 2>&1
```

---

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

1. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –º–æ–¥–µ–ª–∏** —á–µ—Ä–µ–∑ `/admin/castings/{id}/find-models`
2. **–ù–∞–∂–∏–º–∞–µ—Ç "–ó–∞–ø–∏—Å–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–∞—Å—Ç–∏–Ω–≥"**
3. **–ü–∏—Å—å–º–∞ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å** (—Ç–∞–±–ª–∏—Ü–∞ `jobs`)
4. **Scheduler –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É** –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—á–µ—Ä–µ–¥–∏
5. **–ü–∏—Å—å–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è** –º–æ–¥–µ–ª—è–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ SMTP Yandex

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—á–µ—Ä–µ–¥—å:
```bash
php artisan queue:work --once
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥–∏:
```sql
SELECT * FROM jobs;
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏:
```bash
tail -f storage/logs/laravel.log
```

### –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞:
```bash
php artisan tinker
>>> $model = \App\Models\ModelProfile::first();
>>> $casting = \App\Models\CastingApplication::first();
>>> Mail::to('test@example.com')->send(new \App\Mail\CastingInvitationMail($model, $casting));
```

---

## –ß—Ç–æ –Ω–æ–≤–æ–≥–æ

### ‚úÖ –ü—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –º–æ–¥–µ–ª–µ–π
- –ï—Å–ª–∏ —Ç–æ—á–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–µ—Ç, –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –ú–æ–¥–µ–ª–∏ —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –ø—Ä–æ—Ü–µ–Ω—Ç—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ä–∞–∑–Ω–∏—Ü–∞ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö (¬±N —Å–º, ¬±N –ª–µ—Ç)

### ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–µ –ø–∏—Å—å–º–∞
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏
- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å—Ç–∫–∞
- –í—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—Å—Ç–∏–Ω–≥–µ
- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è –º–æ–¥–µ–ª–∏
- –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### ‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ—á–µ—Ä–µ–¥–µ–π
- –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ cron
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (tries=3)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—á—Ç—ã (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ .env)

```env
MAIL_MAILER=smtp
MAIL_HOST=smtp.yandex.ru
MAIL_PORT=465
MAIL_USERNAME=w1nishko@yandex.ru
MAIL_PASSWORD="raknffcjxhxkmvyd"
MAIL_ENCRYPTION=ssl
MAIL_FROM_ADDRESS=w1nishko@yandex.ru
MAIL_FROM_NAME="testagency"
QUEUE_CONNECTION=database
```

---

## –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ

–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ scheduler –æ–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ –≤—ã—à–µ, –∏ –ø–∏—Å—å–º–∞ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
